<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus Route AI - Smart Logistics Intelligence</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <!-- Elegant Background -->
    <div class="bg-gradient-animated"></div>
    
    <!-- Main Container -->
    <div class="app-container">
        <!-- Hero Header -->
        <header class="hero-header">
            <div class="logo-container">
                <svg class="logo-icon" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">
                    <path d="M25 5 L45 15 L45 35 L25 45 L5 35 L5 15 Z" />
                    <circle cx="25" cy="25" r="8" />
                </svg>
                <h1 class="brand-title">Nexus Route AI</h1>
            </div>
            <p class="tagline">Next-gen logistics intelligence powered by Gemini</p>
        </header>

        <!-- Alert Banner -->
        <div id="alert-banner" class="alert-banner hidden">
            <span class="alert-icon">‚ö†Ô∏è</span>
            <span id="alert-message"></span>
            <button class="alert-close" onclick="closeAlert()">√ó</button>
        </div>

        <!-- Route Planner Card -->
        <section class="glass-card planner-card">
            <h2 class="section-title">
                <span class="title-icon">üéØ</span>
                Route Planner
            </h2>
            
            <div class="input-grid">
                <div class="input-wrapper">
                    <label for="source-city" class="floating-label">Origin</label>
                    <div class="select-container">
                        <select id="source-city" class="modern-select">
                            <option value="">Select origin city</option>
                        </select>
                        <span class="select-arrow">
                            <svg width="12" height="8" viewBox="0 0 12 8">
                                <path d="M1 1L6 6L11 1" stroke="currentColor" stroke-width="2" fill="none"/>
                            </svg>
                        </span>
                    </div>
                </div>

                <div class="route-connector">
                    <svg width="40" height="40" viewBox="0 0 40 40">
                        <path d="M5 20 L35 20" stroke="currentColor" stroke-width="2" stroke-dasharray="4 4"/>
                        <circle cx="35" cy="20" r="3" fill="currentColor"/>
                    </svg>
                </div>

                <div class="input-wrapper">
                    <label for="destination-city" class="floating-label">Destination</label>
                    <div class="select-container">
                        <select id="destination-city" class="modern-select">
                            <option value="">Select destination city</option>
                        </select>
                        <span class="select-arrow">
                            <svg width="12" height="8" viewBox="0 0 12 8">
                                <path d="M1 1L6 6L11 1" stroke="currentColor" stroke-width="2" fill="none"/>
                            </svg>
                        </span>
                    </div>
                </div>
            </div>

            <button id="find-route-btn" class="primary-btn">
                <span class="btn-content">
                    <svg class="btn-icon" width="20" height="20" viewBox="0 0 20 20">
                        <path d="M10 2L2 18L18 18Z" fill="currentColor"/>
                    </svg>
                    Calculate Optimal Route
                </span>
            </button>
        </section>

        <!-- AI Features Hub - COLLAPSIBLE AT TOP -->
        <section class="ai-hub collapsible-section">
            <div class="hub-toggle-header" id="ai-hub-toggle">
                <div class="hub-header-content">
                    <h2 class="hub-title gradient-text">ü§ñ AI Command Center</h2>
                    <p class="hub-subtitle">Advanced logistics intelligence tools</p>
                </div>
                <button class="toggle-btn" aria-label="Toggle AI Command Center">
                    <svg class="toggle-icon" width="24" height="24" viewBox="0 0 24 24">
                        <path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>

            <!-- Collapsible Content -->
            <div class="hub-collapsible-content" id="ai-hub-content">
                <!-- Feature Navigation Pills -->
                <nav class="feature-nav">
                    <button class="nav-pill active" data-feature="chat">
                        <span class="pill-icon">üí¨</span>
                        <span class="pill-label">AI Assistant</span>
                    </button>
                    <button class="nav-pill" data-feature="predict">
                        <span class="pill-icon">‚ö°</span>
                        <span class="pill-label">ETA Predict</span>
                    </button>
                    <button class="nav-pill" data-feature="multistop">
                        <span class="pill-icon">üó∫Ô∏è</span>
                        <span class="pill-label">Multi-Stop</span>
                    </button>
                    <button class="nav-pill" data-feature="cost">
                        <span class="pill-icon">üí∞</span>
                        <span class="pill-label">Cost Analysis</span>
                    </button>
                    <button class="nav-pill" data-feature="weather">
                        <span class="pill-icon">üå¶Ô∏è</span>
                        <span class="pill-label">Weather</span>
                    </button>
                    <button class="nav-pill" data-feature="safety">
                        <span class="pill-icon">üõ°Ô∏è</span>
                        <span class="pill-label">Safety</span>
                    </button>
                </nav>

                <!-- Feature Panels -->
                <div class="features-container">
                    <!-- Chat Feature -->
                    <div id="chat-feature" class="feature-panel active glass-card">
                        <div class="chat-messages" id="chat-messages">
                            <div class="welcome-message">
                                <div class="ai-avatar-large">AI</div>
                                <p>Hello! I'm your logistics AI assistant. Ask me anything about routes, delivery optimization, or logistics strategies.</p>
                            </div>
                        </div>
                        <div class="chat-input-container">
                            <input 
                                type="text" 
                                id="chat-input" 
                                class="chat-input" 
                                placeholder="Type your question..."
                                autocomplete="off"
                            />
                            <button class="send-btn" id="chat-send-btn">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <path d="M22 2L11 13M22 2L15 22L11 13M22 2L2 9L11 13" stroke="currentColor" stroke-width="2"/>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- ETA Prediction Feature -->
                    <div id="predict-feature" class="feature-panel glass-card">
                        <h3 class="panel-title">Delivery Time Prediction</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Vehicle Type</label>
                                <select id="vehicle-type" class="modern-input">
                                    <option value="truck">Heavy Truck</option>
                                    <option value="mini-truck">Mini Truck</option>
                                    <option value="van">Delivery Van</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Cargo Weight (kg)</label>
                                <input type="number" id="cargo-weight" class="modern-input" placeholder="e.g., 5000" />
                            </div>
                            <div class="form-group full-width">
                                <label class="form-label">Departure Time</label>
                                <input type="datetime-local" id="departure-time" class="modern-input" />
                            </div>
                        </div>
                        <button class="secondary-btn" id="predict-btn">
                            <span>Generate Prediction</span>
                        </button>
                        <div id="predict-result" class="result-card hidden"></div>
                    </div>

                    <!-- Multi-Stop Feature -->
                    <div id="multistop-feature" class="feature-panel glass-card">
                        <h3 class="panel-title">Multi-Stop Route Optimizer</h3>
                        <div class="form-grid">
                            <div class="form-group full-width">
                                <label class="form-label">Starting Point</label>
                                <select id="start-city" class="modern-input">
                                    <option value="">Select starting city</option>
                                </select>
                            </div>
                            <div class="form-group full-width">
                                <label class="form-label">Add Delivery Stops</label>
                                <div class="add-stop-group">
                                    <select id="stop-city" class="modern-input">
                                        <option value="">Select city to add</option>
                                    </select>
                                    <button class="icon-btn" id="add-stop-btn">
                                        <svg width="20" height="20" viewBox="0 0 20 20">
                                            <path d="M10 5V15M5 10H15" stroke="currentColor" stroke-width="2"/>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div id="stops-display" class="stops-container"></div>
                        <button class="secondary-btn" id="optimize-stops-btn">
                            <span>Optimize Route</span>
                        </button>
                        <div id="multistop-result" class="result-card hidden"></div>
                    </div>

                    <!-- Cost Analysis Feature -->
                    <div id="cost-feature" class="feature-panel glass-card">
                        <h3 class="panel-title">Cost Estimation</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Vehicle Type</label>
                                <select id="cost-vehicle-type" class="modern-input">
                                    <option value="truck">Heavy Truck</option>
                                    <option value="mini-truck">Mini Truck</option>
                                    <option value="van">Delivery Van</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Cargo Weight (kg)</label>
                                <input type="number" id="cost-cargo-weight" class="modern-input" placeholder="e.g., 5000" />
                            </div>
                            <div class="form-group full-width">
                                <label class="form-label">Fuel Price (‚Çπ/liter)</label>
                                <input type="number" id="fuel-price" class="modern-input" value="100" placeholder="100" />
                            </div>
                        </div>
                        <button class="secondary-btn" id="cost-btn">
                            <span>Calculate Costs</span>
                        </button>
                        <div id="cost-result" class="result-card hidden"></div>
                    </div>

                    <!-- Weather Feature -->
                    <div id="weather-feature" class="feature-panel glass-card">
                        <h3 class="panel-title">Weather Impact Analysis</h3>
                        <div class="form-group">
                            <label class="form-label">Season/Period</label>
                            <select id="season" class="modern-input">
                                <option value="current">Current Conditions</option>
                                <option value="summer">Summer (Mar-Jun)</option>
                                <option value="monsoon">Monsoon (Jul-Sep)</option>
                                <option value="winter">Winter (Oct-Feb)</option>
                            </select>
                        </div>
                        <button class="secondary-btn" id="weather-btn">
                            <span>Analyze Impact</span>
                        </button>
                        <div id="weather-result" class="result-card hidden"></div>
                    </div>

                    <!-- Safety Feature -->
                    <div id="safety-feature" class="feature-panel glass-card">
                        <h3 class="panel-title">Safety & Compliance Check</h3>
                        <div class="form-group">
                            <label class="form-label">Cargo Type</label>
                            <select id="cargo-type" class="modern-input">
                                <option value="general">General Goods</option>
                                <option value="perishable">Perishable Items</option>
                                <option value="hazardous">Hazardous Materials</option>
                                <option value="electronics">Electronics</option>
                                <option value="pharmaceuticals">Pharmaceuticals</option>
                            </select>
                        </div>
                        <button class="secondary-btn" id="safety-btn">
                            <span>Run Safety Check</span>
                        </button>
                        <div id="safety-result" class="result-card hidden"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Results Section -->
        <div class="results-layout">
            <!-- Map Container with Toll Calculator -->
            <section class="glass-card map-container">
                <div id="map" class="interactive-map"></div>
                <div id="loader" class="loader-pulse hidden">
                    <div class="pulse-ring"></div>
                    <div class="pulse-ring"></div>
                    <div class="pulse-ring"></div>
                </div>
                
                <!-- Toll Calculator Section -->
                <div id="toll-calculator" class="toll-section hidden">
                    <div class="toll-header">
                        <h3 class="toll-title">
                            <span class="toll-icon">üõ£Ô∏è</span>
                            Estimated Toll Charges
                        </h3>
                        <span class="toll-badge" id="toll-badge">National Highways</span>
                    </div>
                    
                    <div class="toll-content">
                        <div class="toll-summary">
                            <div class="toll-item-main">
                                <span class="toll-label">Total Toll Cost</span>
                                <span class="toll-value" id="total-toll">‚Çπ0</span>
                            </div>
                        </div>
                        
                        <div class="toll-breakdown">
                            <div class="toll-detail-item">
                                <div class="toll-detail-header">
                                    <span class="toll-detail-icon">üöõ</span>
                                    <span class="toll-detail-label">Vehicle Type</span>
                                </div>
                                <select id="toll-vehicle-type" class="toll-select">
                                    <option value="car">Car/Jeep/Van</option>
                                    <option value="lcv">Light Commercial Vehicle</option>
                                    <option value="truck" selected>Heavy Truck (2-Axle)</option>
                                    <option value="multi-axle">Multi-Axle Vehicle (3+ Axle)</option>
                                </select>
                            </div>
                            
                            <div class="toll-detail-item">
                                <div class="toll-detail-header">
                                    <span class="toll-detail-icon">üìä</span>
                                    <span class="toll-detail-label">Route Toll Plazas</span>
                                </div>
                                <div class="toll-plaza-count" id="toll-plaza-count">
                                    <span class="plaza-number">0</span>
                                    <span class="plaza-text">plazas estimated</span>
                                </div>
                            </div>
                            
                            <div class="toll-detail-item">
                                <div class="toll-detail-header">
                                    <span class="toll-detail-icon">üí∞</span>
                                    <span class="toll-detail-label">Cost per 100 km</span>
                                </div>
                                <div class="cost-per-km" id="cost-per-100km">‚Çπ0</div>
                            </div>
                        </div>
                        
                        <div class="toll-details-expand" id="toll-details">
                            <div class="toll-route-info">
                                <h4 class="toll-subtitle">Route Segments</h4>
                                <div id="toll-segments" class="toll-segments-list">
                                    <!-- Dynamically populated -->
                                </div>
                            </div>
                        </div>
                        
                        <div class="toll-footer">
                            <p class="toll-note">
                                <span class="note-icon">‚ÑπÔ∏è</span>
                                Estimates based on NHAI rates. Actual charges may vary. FASTag recommended for seamless travel.
                            </p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Insights Sidebar -->
            <aside class="insights-sidebar">
                <div class="glass-card route-details">
                    <h3 class="card-header">
                        <span class="header-icon">üìä</span>
                        Route Analytics
                    </h3>
                    <div id="route-summary" class="summary-content">
                        <div class="empty-state">
                            <svg class="empty-icon" width="64" height="64" viewBox="0 0 64 64">
                                <circle cx="32" cy="32" r="24" stroke="currentColor" stroke-width="2" fill="none"/>
                                <path d="M32 20 L32 32 L42 38" stroke="currentColor" stroke-width="2" fill="none"/>
                            </svg>
                            <p>Select cities to view route details</p>
                        </div>
                    </div>
                </div>

                <div class="glass-card ai-insights">
                    <h3 class="card-header">
                        <span class="header-icon gradient-text">üß†</span>
                        AI Intelligence
                    </h3>
                    <div id="ai-insights-content" class="insights-content">
                        <div class="empty-state">
                            <div class="ai-avatar">AI</div>
                            <p>Intelligent insights will appear after route calculation</p>
                        </div>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>

<html>
<head>
    <title>U-2</title>
    <meta charset="utf-8">